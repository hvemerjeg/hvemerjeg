#!/bin/bash

#This script is a simple example of a directory enumeration tool through HTTP status code response.

#This script works by sending an HTTP request to the target URL at target directory. Then depending on the status code of the response it determines if the directory exists or no.

#Since there may be redirections when a directory does not exist it may output some false positives.

#This is just an easy script example on how to programm a directory enumeration tool with bash. Not a powerful tool.

#Usage: ./directory_enumeration.sh http://192.168.56.7 dictionary.txt

# Colors
red="\033[1;31;40m"
green="\033[1;32;40m"
reset_color="\033[0m"

if [[ $# -ne 2 ]]
then
	echo -e "$green[+] Usage $0 URL dictionary.txt$reset_color" >&2
	exit 1
fi

# Global variables
url=$1
dictionary=$2

function directoryEnum {
	target_url="$url/$directory"
	status_code=$(curl -sI $target_url | head -n 1 | awk '{print $2}')
	if [[ ! $status_code =~ 404 ]]
	then
		echo -e "$green[+] Found directory --> $target_url$reset_color"
	fi
}

function main {
	echo -e "$green[+] Starting directory enumeration$reset_color\n\n"
	sleep 2
	while read directory
	do
		directoryEnum &
	done < $dictionary; wait
}

main
