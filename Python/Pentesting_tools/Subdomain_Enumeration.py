#DEFAULT PROTOCOL IN USE IS HTTP
#THIS SCRIPT DOES NOT IMPLEMENT THREADS. IF YOU WANT A FAST TOOL USE gobuster, dirbuster, dirb, ETC.
#THIS IS ONLY A TINY PYTHON SCRIPT THAT SHOWS HOW TO PROGRAM A TINY DIRECTORY ENUMERATION TOOL
import requests, os, sys, time

#Colors
green = "\033[1;32;40m"
red = "\033[1;31;40m"
reset_color = "\033[0m"

if len(sys.argv) < 3:
	print(f"Ipv4 not supplied")
	exit(f"{red}[+] Usage example: {sys.argv[0]} domain_or_ip dictionary.txt{reset_color}")

def main():
	domain = sys.argv[1]
	dictionary = sys.argv[2]
	dictionary_stream = openDictionary(dictionary)
	print(f"{green}[+] Brute forcing directories{reset_color}\n\n")
	time.sleep(1)	
	for directory in dictionary_stream:
		target_uri = f"http://{domain}/{directory.strip()}" #CHANGE THIS LINE TO USE A DIFFERENT PROTOCOL
		makeRequest(target_uri)

	dictionary_stream.close()		

def makeRequest(url: str):
	try:
		r = requests.get(url)
		if r.status_code != 404:
			print(f"{green}[+] Directory found --> {url}{reset_color}")
	except KeyboardInterrupt:
		exit()
	except:
		pass
def openDictionary(dictionary: str):
	try:
		f = open(dictionary)
	except IOError as e:
		exit(f"{red}{os.strerror(e.errno)}{reset_color}")
	return f

if __name__ == '__main__':
	main()
